<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Internal Linking Optimization Wizard | XnY</title>
    <link rel="icon" type="image/png" href="assets/logo-x.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <style>
        .step-indicator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .step-complete {
            background: #10b981;
        }
        .step-current {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            animation: pulse 2s infinite;
        }
        .step-pending {
            background: #e5e7eb;
            color: #9ca3af;
        }
        .wizard-content {
            min-height: 500px;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .checkbox-custom {
            position: relative;
        }
        .checkbox-custom input[type="checkbox"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }
        .checkbox-custom input[type="checkbox"]:checked {
            background: #667eea;
        }
        .checkbox-custom input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            left: 3px;
            top: -2px;
            color: white;
            font-weight: bold;
        }
        .radio-custom {
            position: relative;
        }
        .radio-custom input[type="radio"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 50%;
            background: white;
            cursor: pointer;
        }
        .radio-custom input[type="radio"]:checked {
            background: #667eea;
            border: 2px solid #667eea;
        }
        .radio-custom input[type="radio"]:checked::after {
            content: '';
            position: absolute;
            left: 6px;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="step-indicator text-white py-6 px-4">
        <div class="max-w-4xl mx-auto">
            <div class="flex flex-col items-center gap-4 mb-4">
                <img src="assets/logo.png" alt="XnY Logo" class="h-12 w-auto mr-4">
                <div>
                    <h1 class="text-3xl font-bold mb-1">üöÄ Internal Linking Optimization Wizard</h1>
                    <p class="text-lg opacity-90">Transform your website's internal linking strategy with data-driven insights</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Steps -->
    <div class="max-w-4xl mx-auto px-4 py-6">
        <div class="flex items-center justify-between mb-8">
            <div id="step-0" class="flex items-center step-current rounded-full px-4 py-2 text-white font-semibold text-sm">
                <span class="mr-2">üìÇ</span>Data Selection
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-1" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">üìã</span>Business Goals
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-2" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">üîç</span>Assessment
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-3" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">üéØ</span>Page Priority
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-4" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">‚öôÔ∏è</span>Technical
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-5" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">üìä</span>Reports
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
            <div id="step-6" class="flex items-center step-pending rounded-full px-4 py-2 text-sm">
                <span class="mr-2">‚úÖ</span>Confirmation
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto px-4 pb-8">
        <div class="bg-white rounded-lg shadow-lg p-8 wizard-content">
            <!-- Phase 0: Data File Selection -->
            <div id="phase-0" class="phase-content fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìÇ Data File Selection</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-2">üí° How to get your internal linking data:</h3>
                    <ol class="list-decimal list-inside text-blue-700 space-y-1">
                        <li>Go to <strong>SEMrush ‚Üí Site Audit</strong></li>
                        <li>Click <strong>"View Details"</strong> on Internal Links</li>
                        <li>Click <strong>"Export to CSV"</strong> at the top right</li>
                        <li>Save the file in your data directory</li>
                    </ol>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Select your CSV data file:</label>
                    <select id="dataFileSelect" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Choose a data file...</option>
                        <option value="naecleaningsolutions.com_pages_20250923.csv">naecleaningsolutions.com_pages_20250923.csv (19 KB, modified: 9/23/2025)</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="confirmDataFile" class="mr-3">
                        <span class="text-gray-700">I confirm this is the correct data file for my website analysis</span>
                    </label>
                </div>
            </div>

            <!-- Phase 1: Welcome & Business Goals -->
            <div id="phase-1" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìã Welcome & Business Goals</h2>
                
                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="welcomeConfirm" class="mr-3" checked>
                        <span class="text-gray-700">Welcome! I'm ready to optimize my internal linking strategy</span>
                    </label>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">What is your primary business goal for internal linking optimization?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="primaryGoal" value="conversions" class="mr-3">
                            <div>
                                <span class="font-medium">Increase Conversions</span>
                                <span class="text-gray-500 block text-sm">Focus on Money Pages</span>
                            </div>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="primaryGoal" value="traffic" class="mr-3">
                            <div>
                                <span class="font-medium">Boost Organic Traffic</span>
                                <span class="text-gray-500 block text-sm">Focus on Content Pages</span>
                            </div>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="primaryGoal" value="authority" class="mr-3">
                            <div>
                                <span class="font-medium">Build Authority & Trust</span>
                                <span class="text-gray-500 block text-sm">Focus on Supporting Content</span>
                            </div>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="primaryGoal" value="balanced" class="mr-3" checked>
                            <div>
                                <span class="font-medium">Balanced Approach</span>
                                <span class="text-gray-500 block text-sm">All Content Types</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">What type of website are you optimizing?</label>
                    <select id="websiteType" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="service">Service-based business (like NAE Cleaning)</option>
                        <option value="ecommerce">E-commerce store</option>
                        <option value="blog">Content/blog site</option>
                        <option value="corporate">Corporate website</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <!-- Phase 2: Current State Assessment -->
            <div id="phase-2" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üîç Current State Assessment</h2>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Which areas need the most attention? (Select all that apply)</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="orphaned" class="mr-3" checked>
                            <span>Fix orphaned pages (pages with no internal links)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="distribution" class="mr-3" checked>
                            <span>Improve link distribution across content tiers</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="clusters" class="mr-3">
                            <span>Create topic clusters and hub pages</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="anchors" class="mr-3">
                            <span>Optimize anchor text strategy</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="technical" class="mr-3" checked>
                            <span>Fix technical issues (broken links, etc.)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="optimizationAreas" value="architecture" class="mr-3">
                            <span>Improve site architecture</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">What is your content creation capacity?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="contentCapacity" value="high" class="mr-3">
                            <span>High - I can create new content and modify existing pages</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="contentCapacity" value="medium" class="mr-3" checked>
                            <span>Medium - I can modify existing content but limited new content</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="contentCapacity" value="low" class="mr-3">
                            <span>Low - I prefer to work with existing content only</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">What is your preferred implementation timeline?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="timeline" value="aggressive" class="mr-3">
                            <span>1 month - Aggressive optimization</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="timeline" value="moderate" class="mr-3" checked>
                            <span>3 months - Moderate, steady progress</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="timeline" value="gradual" class="mr-3">
                            <span>6 months - Gradual, sustainable approach</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Phase 3: Page Priority Selection -->
            <div id="phase-3" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üéØ Page Priority Selection</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-2">üí° Understanding the Metrics & Tiers:</h3>
                    <div class="text-blue-700 space-y-1">
                        <p><strong>ILR (Internal Link Ratio):</strong> A score from 0-100 that measures how well a page is internally linked within your website. Higher scores (90-100) indicate pages that are strongly connected through your site's internal linking structure.</p>
                        <p><strong>Links:</strong> The number of internal links pointing to this page from other pages on your site.</p>
                        <p class="text-sm mt-2"><strong>The 3 Tiers:</strong></p>
                        <ul class="text-sm ml-4 space-y-1">
                            <li>üí∞ <strong>Money Pages:</strong> High-converting service pages (goal: 95-100 ILR)</li>
                            <li>ü§ù <strong>Supporting Pages:</strong> Trust-building content like About, Contact (goal: 80-95 ILR)</li>
                            <li>üìà <strong>Traffic Pages:</strong> Blog posts, guides, informational content (goal: 60-80 ILR)</li>
                        </ul>
                    </div>
                </div>
                
                <!-- MONEY PAGES SECTION -->
                <div class="mb-8 border-2 border-green-200 rounded-lg p-6 bg-green-50">
                    <h3 class="text-xl font-bold text-green-800 mb-4 flex items-center">
                        <span class="text-2xl mr-2">üí∞</span> Money Pages (High-Converting Service Pages)
                    </h3>
                    <p class="text-sm text-green-700 mb-4">These are your main service pages that drive conversions. Select the pages most critical to your business.</p>
                    
                    <label class="block text-sm font-medium text-gray-700 mb-3">Select your priority service/money pages:</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="bank-cleaning-services-austin" class="mr-3" checked>
                            <span>Expert Financial Institutions & Bank Cleaning Services (ILR: 100, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="medical-facility-cleaning-austin" class="mr-3" checked>
                            <span>Medical Cleaning Services (ILR: 100, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="office-cleaning-service-austin" class="mr-3" checked>
                            <span>Office Cleaning Service (ILR: 100, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="school-cleaning-services-austin" class="mr-3" checked>
                            <span>Cleaning Services for Schools (ILR: 100, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="auto-dealership-cleaning-austin" class="mr-3">
                            <span>Car Dealership Cleaning Service (ILR: 98, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="warehouse-cleaning-services-in-austin" class="mr-3">
                            <span>Expert Warehouse Cleaning Services (ILR: 98, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="moneyPages" value="church-cleaning-services-austin" class="mr-3">
                            <span>Church Cleaning Services (ILR: 100, Links: 64)</span>
                        </label>
                    </div>
                    
                    <!-- Other Money Pages Input -->
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Other service/money pages:</label>
                        <div class="relative">
                            <input type="text" id="otherMoneyPages" placeholder="Type to search for other pages..." 
                                   class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <div id="moneyPagesDropdown" class="absolute z-50 w-full bg-white border border-gray-300 rounded-md shadow-lg hidden max-h-60 overflow-y-auto top-full mt-1">
                                <!-- Autocomplete suggestions will appear here -->
                            </div>
                        </div>
                        <div id="selectedOtherMoneyPages" class="mt-2 space-y-2">
                            <!-- Selected pages will appear here -->
                        </div>
                    </div>
                    
                    <!-- Custom Money Page URL Input -->
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Add custom money page URL (not in CSV):</label>
                        <div class="flex gap-2">
                            <input type="text" id="customMoneyPageUrl" placeholder="https://example.com/page-url" 
                                   class="flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" id="customMoneyPageTitle" placeholder="Page Title" 
                                   class="flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button type="button" id="addCustomMoneyPage" class="px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors whitespace-nowrap">
                                + Add
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Use this to add pages that SEMrush might not have crawled due to crawl limits.</p>
                        <div id="customMoneyPages" class="mt-2 space-y-2">
                            <!-- Custom pages will appear here -->
                        </div>
                    </div>
                </div>

                <!-- SUPPORTING PAGES SECTION -->
                <div class="mb-8 border-2 border-blue-200 rounded-lg p-6 bg-blue-50">
                    <h3 class="text-xl font-bold text-blue-800 mb-4 flex items-center">
                        <span class="text-2xl mr-2">ü§ù</span> Supporting Pages (Trust & Authority Building)
                    </h3>
                    <p class="text-sm text-blue-700 mb-4">These pages build trust and support your money pages. Examples: About, Contact, Testimonials, etc.</p>
                    
                    <label class="block text-sm font-medium text-gray-700 mb-3">Select your supporting content pages:</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="supportingPages" value="about" class="mr-3" checked>
                            <span>About Page (ILR: 88, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="supportingPages" value="day-porter-services-austin" class="mr-3" checked>
                            <span>Day Porter Services (ILR: 93, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="supportingPages" value="commercal-carpet-cleaning-austin" class="mr-3" checked>
                            <span>Commercial Carpet Cleaning (ILR: 90, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="supportingPages" value="commercial-floor-cleaning-austin" class="mr-3" checked>
                            <span>Commercial Floor Cleaning (ILR: 90, Links: 64)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="supportingPages" value="contact" class="mr-3" checked>
                            <span>Contact Page (ILR: 71, Links: 63)</span>
                        </label>
                    </div>
                    
                    <!-- Other Supporting Pages Input -->
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Other supporting pages:</label>
                        <div class="relative">
                            <input type="text" id="otherSupportingPages" placeholder="Type to search for other pages..." 
                                   class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <div id="supportingPagesDropdown" class="absolute z-50 w-full bg-white border border-gray-300 rounded-md shadow-lg hidden max-h-60 overflow-y-auto top-full mt-1">
                                <!-- Autocomplete suggestions will appear here -->
                            </div>
                        </div>
                        <div id="selectedOtherSupportingPages" class="mt-2 space-y-2">
                            <!-- Selected pages will appear here -->
                        </div>
                    </div>
                    
                    <!-- Custom Supporting Page URL Input -->
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Add custom supporting page URL (not in CSV):</label>
                        <div class="flex gap-2">
                            <input type="text" id="customSupportingPageUrl" placeholder="https://example.com/page-url" 
                                   class="flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" id="customSupportingPageTitle" placeholder="Page Title" 
                                   class="flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button type="button" id="addCustomSupportingPage" class="px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors whitespace-nowrap">
                                + Add
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Use this to add pages that SEMrush might not have crawled due to crawl limits.</p>
                        <div id="customSupportingPages" class="mt-2 space-y-2">
                            <!-- Custom pages will appear here -->
                        </div>
                    </div>
                </div>

                <!-- TRAFFIC PAGES SECTION -->
                <div class="mb-8 border-2 border-purple-200 rounded-lg p-6 bg-purple-50">
                    <h3 class="text-xl font-bold text-purple-800 mb-4 flex items-center">
                        <span class="text-2xl mr-2">üìà</span> Traffic Pages (Blog Posts & Educational Content)
                    </h3>
                    <p class="text-sm text-purple-700 mb-4">All pages NOT selected above are automatically categorized as Traffic Pages. These drive organic search traffic through informational content.</p>
                    
                    <div class="bg-purple-100 border-l-4 border-purple-400 p-3 mb-4">
                        <p class="text-sm text-purple-800">
                            <strong>‚ÑπÔ∏è Note:</strong> Any page from your CSV that you don't check as Money or Supporting will automatically become a Traffic Page in your report.
                        </p>
                    </div>
                    
                    <label class="block text-sm font-medium text-gray-700 mb-3">How should we handle your blog/traffic content optimization?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="blogStrategy" value="high-traffic" class="mr-3">
                            <span>Focus on high-traffic blog posts first</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="blogStrategy" value="clusters" class="mr-3" checked>
                            <span>Create topic clusters around main services</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="blogStrategy" value="equal" class="mr-3">
                            <span>Optimize all blog posts equally</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="blogStrategy" value="skip" class="mr-3">
                            <span>Skip blog/traffic optimization for now</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Phase 4: Technical Preferences -->
            <div id="phase-4" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è Technical Preferences</h2>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Do you use WordPress for your website?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="wordpressIntegration" value="yes" class="mr-3" checked>
                            <span>Yes - I use WordPress and want plugin recommendations</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="wordpressIntegration" value="no" class="mr-3">
                            <span>No - I use a different CMS/platform</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="wordpressIntegration" value="unsure" class="mr-3">
                            <span>Not sure - I want general recommendations</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6" id="wordpressPluginSection">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Which WordPress plugin would you prefer for internal linking?</label>
                    <select id="wordpressPlugin" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="link-whisper">Link Whisper (Recommended)</option>
                        <option value="internal-link-juicer">Internal Link Juicer</option>
                        <option value="yoast">Yoast SEO</option>
                        <option value="manual">Manual implementation</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">How do you prefer to manage internal links?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="linkManagement" value="automated" class="mr-3">
                            <span>Automated tools (plugins, scripts)</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="linkManagement" value="manual" class="mr-3">
                            <span>Manual implementation with detailed instructions</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="linkManagement" value="hybrid" class="mr-3" checked>
                            <span>Hybrid approach (automated + manual review)</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Which tools do you currently use for SEO monitoring?</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="gsc" class="mr-3" checked>
                            <span>Google Search Console</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="ga" class="mr-3" checked>
                            <span>Google Analytics</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="screaming-frog" class="mr-3">
                            <span>Screaming Frog SEO Spider</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="ahrefs" class="mr-3">
                            <span>Ahrefs</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="semrush" class="mr-3">
                            <span>SEMrush</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="monitoringTools" value="none" class="mr-3">
                            <span>None of the above</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Phase 5: Report Preferences -->
            <div id="phase-5" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">üìä Report Preferences</h2>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">How detailed should your optimization report be?</label>
                    <div class="space-y-3">
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="reportDetail" value="summary" class="mr-3">
                            <span>Executive Summary - High-level overview and key actions</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="reportDetail" value="detailed" class="mr-3">
                            <span>Detailed Analysis - Comprehensive report with all findings</span>
                        </label>
                        <label class="flex items-center radio-custom">
                            <input type="radio" name="reportDetail" value="action-focused" class="mr-3" checked>
                            <span>Action-Focused - Prioritized tasks and implementation steps</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">How would you like to receive your optimization report?</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="outputFormats" value="console" class="mr-3" checked>
                            <span>Console display (terminal output)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="outputFormats" value="markdown" class="mr-3" checked>
                            <span>Markdown file (.md)</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="outputFormats" value="csv" class="mr-3">
                            <span>CSV file for spreadsheet analysis</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="outputFormats" value="html" class="mr-3" checked>
                            <span>HTML report for web viewing</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="createActionPlan" class="mr-3" checked>
                        <span class="text-gray-700">Create a detailed action plan with specific tasks and deadlines</span>
                    </label>
                </div>

                <div class="mb-6" id="advancedMetricsSection" style="display: none;">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Include advanced metrics in your report?</label>
                    <div class="space-y-3">
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="advancedMetrics" value="anchor-text" class="mr-3">
                            <span>Anchor text distribution analysis</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="advancedMetrics" value="link-equity" class="mr-3">
                            <span>Link equity flow visualization</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="advancedMetrics" value="competitor" class="mr-3">
                            <span>Competitor comparison data</span>
                        </label>
                        <label class="flex items-center checkbox-custom">
                            <input type="checkbox" name="advancedMetrics" value="historical" class="mr-3">
                            <span>Historical performance trends</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Phase 6: Confirmation & Execution -->
            <div id="phase-6" class="phase-content hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">‚úÖ Confirmation & Execution</h2>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4">üìã Your Selections Summary:</h3>
                    <div id="selectionsSummary" class="space-y-2 text-blue-700">
                        <!-- Summary will be populated by JavaScript -->
                    </div>
                </div>

                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="confirmAnalysis" class="mr-3" checked>
                        <span class="text-gray-700 font-medium">Ready to analyze your website data and generate optimization recommendations?</span>
                    </label>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">üöÄ Ready to Transform Your Internal Linking!</h3>
                    <p class="text-green-700 mb-4">Your optimization wizard is complete. Click "Generate Report" to create your personalized internal linking strategy.</p>
                    <button id="generateReport" class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                        Generate Optimization Report
                    </button>
                </div>

                <!-- Report Results Section (hidden initially) -->
                <div id="reportResults" class="hidden mt-8 space-y-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-blue-800 mb-4">üìä Your Optimization Report</h3>
                        <div id="reportContent">
                            <!-- Report content will be inserted here -->
                        </div>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üì• Download Reports</h3>
                        <div id="downloadLinks" class="space-y-3">
                            <!-- Download links will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between mt-8 pt-6 border-t border-gray-200">
                <button id="prevBtn" class="bg-gray-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-gray-600 transition-colors" style="display: none;">
                    ‚Üê Previous
                </button>
                <div class="flex-1"></div>
                <button id="nextBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                    Next ‚Üí
                </button>
            </div>
        </div>

        <!-- Previous Steps Sidebar -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìù Previous Steps Summary</h3>
            <div id="previousSteps" class="space-y-4">
                <p class="text-gray-500 text-sm">Complete each step to see your selections here.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-12">
        <div class="max-w-4xl mx-auto px-4">
            <div class="flex items-center justify-center">
                <img src="assets/logo-x.png" alt="XnY Icon" class="h-8 w-8 mr-3">
                <span class="text-lg">Powered by <strong>XnY</strong></span>
            </div>
            <div class="text-center text-gray-400 text-sm mt-2">
                Internal Linking Optimization Tool
            </div>
        </div>
    </footer>

    <script>
        $(document).ready(function() {
            let currentPhase = 0;
            const totalPhases = 7;
            const wizardData = {};
            let allPagesData = []; // Local data store for fast autocomplete

            // Load all CSV data on page load for fast autocomplete
            loadAllPagesData();

            // Define all functions first
            window.searchPages = function(query, type, dropdownSelector) {
                console.log('Searching locally for:', query, 'Type:', type); // Debug log
                
                // Filter local data instead of AJAX call
                const queryLower = query.toLowerCase();
                let filteredPages = allPagesData.filter(page => {
                    // NOTE: Removed tier filtering to allow all pages to be selectable
                    // Users can now search and select any page regardless of its automatic categorization
                    
                    // If query is empty, show all pages
                    if (query === '') {
                        return true;
                    }
                    
                    // Search in title and URL
                    return page.title.toLowerCase().includes(queryLower) || 
                           page.url.toLowerCase().includes(queryLower);
                });
                
                // Sort by ILR score (highest first) and limit to 15 for better selection
                filteredPages.sort((a, b) => b.ilr - a.ilr);
                filteredPages = filteredPages.slice(0, 15);
                
                console.log('Found', filteredPages.length, 'local results'); // Debug log
                window.displayPageSuggestions(filteredPages, dropdownSelector, type);
            };

            window.displayPageSuggestions = function(suggestions, dropdownSelector, type) {
                console.log('Displaying suggestions:', suggestions.length, 'in', dropdownSelector); // Debug log
                const dropdown = $(dropdownSelector);
                dropdown.empty();

                if (suggestions.length === 0) {
                    dropdown.html('<div class="p-3 text-gray-500">No pages found</div>');
                } else {
                    suggestions.forEach(page => {
                        const pageJson = JSON.stringify(page).replace(/'/g, '&#39;'); // Escape quotes
                        const item = $(`
                            <div class="p-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100 suggestion-item" 
                                 data-page='${pageJson}' data-type="${type}">
                                <div class="font-medium text-gray-800">${page.title || 'Untitled'}</div>
                                <div class="text-sm text-gray-600">ILR: ${page.ilr}, Links: ${page.incomingLinks}</div>
                                <div class="text-xs text-gray-500">${page.url}</div>
                            </div>
                        `);
                        dropdown.append(item);
                    });
                }

                dropdown.removeClass('hidden');
                console.log('Dropdown should now be visible'); // Debug log
            };

            // Initialize wizard
            updateStepIndicators();
            updateNavigationButtons();

            // Navigation event handlers
            $('#nextBtn').click(function() {
                if (validateCurrentPhase()) {
                    saveCurrentPhaseData();
                    if (currentPhase < totalPhases - 1) {
                        currentPhase++;
                        showPhase(currentPhase);
                        updateStepIndicators();
                        updateNavigationButtons();
                        updatePreviousSteps();
                    }
                }
            });

            $('#prevBtn').click(function() {
                if (currentPhase > 0) {
                    currentPhase--;
                    showPhase(currentPhase);
                    updateStepIndicators();
                    updateNavigationButtons();
                }
            });

            // WordPress integration conditional logic
            $('input[name="wordpressIntegration"]').change(function() {
                if ($(this).val() === 'yes') {
                    $('#wordpressPluginSection').show();
                } else {
                    $('#wordpressPluginSection').hide();
                }
            });

            // Report detail conditional logic
            $('input[name="reportDetail"]').change(function() {
                if ($(this).val() === 'detailed') {
                    $('#advancedMetricsSection').show();
                } else {
                    $('#advancedMetricsSection').hide();
                }
            });

            // Generate report button
            $('#generateReport').click(function() {
                saveCurrentPhaseData();
                generateOptimizationReport();
            });

            // Add custom money page functionality
            $('#addCustomMoneyPage').click(function() {
                const url = $('#customMoneyPageUrl').val().trim();
                const title = $('#customMoneyPageTitle').val().trim();
                
                if (!url || !title) {
                    alert('Please enter both URL and title for the custom page.');
                    return;
                }
                
                // Basic URL validation
                try {
                    new URL(url);
                } catch (e) {
                    alert('Please enter a valid URL (e.g., https://example.com/page)');
                    return;
                }
                
                // Add custom page to the list
                const customPageId = `custom-money-${Date.now()}`;
                const customPageHtml = `
                    <div id="${customPageId}" class="flex items-center justify-between bg-yellow-50 border border-yellow-200 p-3 rounded-lg">
                        <div>
                            <div class="font-medium text-gray-800">${title}</div>
                            <div class="text-sm text-gray-600">Custom URL (not in CSV)</div>
                            <div class="text-xs text-gray-500">${url}</div>
                        </div>
                        <button type="button" class="text-red-600 hover:text-red-800 font-semibold" onclick="removeCustomPage('${customPageId}')">
                            ‚úï Remove
                        </button>
                    </div>
                `;
                
                $('#customMoneyPages').append(customPageHtml);
                
                // Clear inputs
                $('#customMoneyPageUrl').val('');
                $('#customMoneyPageTitle').val('');
            });

            // Add custom supporting page functionality
            $('#addCustomSupportingPage').click(function() {
                const url = $('#customSupportingPageUrl').val().trim();
                const title = $('#customSupportingPageTitle').val().trim();
                
                if (!url || !title) {
                    alert('Please enter both URL and title for the custom page.');
                    return;
                }
                
                // Basic URL validation
                try {
                    new URL(url);
                } catch (e) {
                    alert('Please enter a valid URL (e.g., https://example.com/page)');
                    return;
                }
                
                // Add custom page to the list
                const customPageId = `custom-supporting-${Date.now()}`;
                const customPageHtml = `
                    <div id="${customPageId}" class="flex items-center justify-between bg-yellow-50 border border-yellow-200 p-3 rounded-lg">
                        <div>
                            <div class="font-medium text-gray-800">${title}</div>
                            <div class="text-sm text-gray-600">Custom URL (not in CSV)</div>
                            <div class="text-xs text-gray-500">${url}</div>
                        </div>
                        <button type="button" class="text-red-600 hover:text-red-800 font-semibold" onclick="removeCustomPage('${customPageId}')">
                            ‚úï Remove
                        </button>
                    </div>
                `;
                
                $('#customSupportingPages').append(customPageHtml);
                
                // Clear inputs
                $('#customSupportingPageUrl').val('');
                $('#customSupportingPageTitle').val('');
            });

            // Autocomplete functionality for money pages
            let moneyPagesDebounce;
            $('#otherMoneyPages').on('input', function() {
                const query = $(this).val().trim();
                clearTimeout(moneyPagesDebounce);
                
                moneyPagesDebounce = setTimeout(() => {
                    window.searchPages(query, 'money', '#moneyPagesDropdown');
                }, 100);
            });

            // Show all pages when focused but empty
            $('#otherMoneyPages').on('focus', function() {
                if ($(this).val().trim() === '') {
                    window.searchPages('', 'money', '#moneyPagesDropdown');
                }
            });

            // Autocomplete functionality for supporting pages  
            let supportingPagesDebounce;
            $('#otherSupportingPages').on('input', function() {
                const query = $(this).val().trim();
                clearTimeout(supportingPagesDebounce);
                
                supportingPagesDebounce = setTimeout(() => {
                    window.searchPages(query, 'supporting', '#supportingPagesDropdown');
                }, 100);
            });

            // Show all pages when focused but empty
            $('#otherSupportingPages').on('focus', function() {
                if ($(this).val().trim() === '') {
                    window.searchPages('', 'supporting', '#supportingPagesDropdown');
                }
            });

            // Hide dropdowns when clicking outside
            $(document).click(function(e) {
                if (!$(e.target).closest('#otherMoneyPages, #moneyPagesDropdown').length) {
                    $('#moneyPagesDropdown').addClass('hidden');
                }
                if (!$(e.target).closest('#otherSupportingPages, #supportingPagesDropdown').length) {
                    $('#supportingPagesDropdown').addClass('hidden');
                }
            });

            function showPhase(phaseNum) {
                $('.phase-content').hide();
                $(`#phase-${phaseNum}`).show().addClass('fade-in');
                setTimeout(() => $(`#phase-${phaseNum}`).removeClass('fade-in'), 500);
            }

            function updateStepIndicators() {
                for (let i = 0; i < totalPhases; i++) {
                    const step = $(`#step-${i}`);
                    step.removeClass('step-complete step-current step-pending');
                    
                    if (i < currentPhase) {
                        step.addClass('step-complete');
                    } else if (i === currentPhase) {
                        step.addClass('step-current');
                    } else {
                        step.addClass('step-pending');
                    }
                }
            }

            function updateNavigationButtons() {
                if (currentPhase === 0) {
                    $('#prevBtn').hide();
                } else {
                    $('#prevBtn').show();
                }

                if (currentPhase === totalPhases - 1) {
                    $('#nextBtn').hide();
                } else {
                    $('#nextBtn').show();
                }
            }

            function validateCurrentPhase() {
                switch (currentPhase) {
                    case 0: // Data File Selection
                        if (!$('#dataFileSelect').val()) {
                            alert('Please select a data file.');
                            return false;
                        }
                        if (!$('#confirmDataFile').is(':checked')) {
                            alert('Please confirm this is the correct data file.');
                            return false;
                        }
                        break;
                    case 1: // Business Goals
                        if (!$('input[name="primaryGoal"]:checked').length) {
                            alert('Please select your primary business goal.');
                            return false;
                        }
                        break;
                    case 2: // Assessment
                        if (!$('input[name="optimizationAreas"]:checked').length) {
                            alert('Please select at least one optimization area.');
                            return false;
                        }
                        break;
                    case 3: // Page Priority
                        if (!$('input[name="moneyPages"]:checked').length) {
                            alert('Please select at least one money page.');
                            return false;
                        }
                        break;
                    case 5: // Report Preferences
                        if (!$('input[name="outputFormats"]:checked').length) {
                            alert('Please select at least one output format.');
                            return false;
                        }
                        break;
                }
                return true;
            }

            function saveCurrentPhaseData() {
                switch (currentPhase) {
                    case 0:
                        wizardData.selectedDataFile = $('#dataFileSelect').val();
                        wizardData.confirmDataFile = $('#confirmDataFile').is(':checked');
                        break;
                    case 1:
                        wizardData.primaryGoal = $('input[name="primaryGoal"]:checked').val();
                        wizardData.websiteType = $('#websiteType').val();
                        break;
                    case 2:
                        wizardData.optimizationAreas = $('input[name="optimizationAreas"]:checked').map(function() {
                            return this.value;
                        }).get();
                        wizardData.contentCapacity = $('input[name="contentCapacity"]:checked').val();
                        wizardData.timeline = $('input[name="timeline"]:checked').val();
                        break;
                    case 3:
                        wizardData.moneyPages = $('input[name="moneyPages"]:checked').map(function() {
                            return this.value;
                        }).get();
                        wizardData.supportingPages = $('input[name="supportingPages"]:checked').map(function() {
                            return this.value;
                        }).get();
                        wizardData.blogStrategy = $('input[name="blogStrategy"]:checked').val();
                        
                        // Collect custom money pages
                        wizardData.customMoneyPages = [];
                        $('#customMoneyPages > div').each(function() {
                            const title = $(this).find('.font-medium').text();
                            const url = $(this).find('.text-xs').text();
                            wizardData.customMoneyPages.push({ title, url });
                        });
                        
                        // Collect custom supporting pages
                        wizardData.customSupportingPages = [];
                        $('#customSupportingPages > div').each(function() {
                            const title = $(this).find('.font-medium').text();
                            const url = $(this).find('.text-xs').text();
                            wizardData.customSupportingPages.push({ title, url });
                        });
                        break;
                    case 4:
                        wizardData.wordpressIntegration = $('input[name="wordpressIntegration"]:checked').val();
                        if (wizardData.wordpressIntegration === 'yes') {
                            wizardData.wordpressPlugin = $('#wordpressPlugin').val();
                        }
                        wizardData.linkManagement = $('input[name="linkManagement"]:checked').val();
                        wizardData.monitoringTools = $('input[name="monitoringTools"]:checked').map(function() {
                            return this.value;
                        }).get();
                        break;
                    case 5:
                        wizardData.reportDetail = $('input[name="reportDetail"]:checked').val();
                        wizardData.outputFormats = $('input[name="outputFormats"]:checked').map(function() {
                            return this.value;
                        }).get();
                        wizardData.createActionPlan = $('#createActionPlan').is(':checked');
                        if (wizardData.reportDetail === 'detailed') {
                        wizardData.advancedMetrics = $('input[name="advancedMetrics"]:checked').map(function() {
                            return this.value;
                        }).get();
                    }
                    break;
                case 6:
                    wizardData.confirmAnalysis = $('#confirmAnalysis').is(':checked');
                    break;
            }

            // Save other selected pages
            if (currentPhase === 3) {
                wizardData.otherMoneyPages = getSelectedOtherPages('money');
                wizardData.otherSupportingPages = getSelectedOtherPages('supporting');
            }
            }

            function updatePreviousSteps() {
                const summaryHtml = [];
                
                if (wizardData.selectedDataFile) {
                    summaryHtml.push(`<div class="p-3 bg-gray-50 rounded border-l-4 border-blue-400">
                        <strong>üìÇ Data File:</strong> ${wizardData.selectedDataFile}
                    </div>`);
                }
                
                if (wizardData.primaryGoal) {
                    const goalLabels = {
                        conversions: 'Increase Conversions',
                        traffic: 'Boost Organic Traffic',
                        authority: 'Build Authority & Trust',
                        balanced: 'Balanced Approach'
                    };
                    summaryHtml.push(`<div class="p-3 bg-gray-50 rounded border-l-4 border-green-400">
                        <strong>üìã Primary Goal:</strong> ${goalLabels[wizardData.primaryGoal]}
                    </div>`);
                }
                
                if (wizardData.optimizationAreas && wizardData.optimizationAreas.length > 0) {
                    summaryHtml.push(`<div class="p-3 bg-gray-50 rounded border-l-4 border-yellow-400">
                        <strong>üîç Focus Areas:</strong> ${wizardData.optimizationAreas.length} selected
                    </div>`);
                }
                
                if (wizardData.moneyPages && wizardData.moneyPages.length > 0) {
                    const customCount = wizardData.customMoneyPages ? wizardData.customMoneyPages.length : 0;
                    const totalMoney = wizardData.moneyPages.length + customCount;
                    const customText = customCount > 0 ? ` (${customCount} custom)` : '';
                    summaryHtml.push(`<div class="p-3 bg-gray-50 rounded border-l-4 border-purple-400">
                        <strong>üéØ Money Pages:</strong> ${totalMoney} selected${customText}
                    </div>`);
                }
                
                if (wizardData.outputFormats && wizardData.outputFormats.length > 0) {
                    summaryHtml.push(`<div class="p-3 bg-gray-50 rounded border-l-4 border-indigo-400">
                        <strong>üìä Report Formats:</strong> ${wizardData.outputFormats.join(', ')}
                    </div>`);
                }
                
                if (summaryHtml.length > 0) {
                    $('#previousSteps').html(summaryHtml.join(''));
                }

                // Update confirmation summary
                if (currentPhase === 6) {
                    updateConfirmationSummary();
                }
            }

            function updateConfirmationSummary() {
                const summaryItems = [];
                
                if (wizardData.selectedDataFile) {
                    summaryItems.push(`<strong>Data File:</strong> ${wizardData.selectedDataFile}`);
                }
                if (wizardData.primaryGoal) {
                    const goalLabels = {
                        conversions: 'Increase Conversions',
                        traffic: 'Boost Organic Traffic', 
                        authority: 'Build Authority & Trust',
                        balanced: 'Balanced Approach'
                    };
                    summaryItems.push(`<strong>Business Goal:</strong> ${goalLabels[wizardData.primaryGoal]}`);
                }
                if (wizardData.websiteType) {
                    summaryItems.push(`<strong>Website Type:</strong> ${wizardData.websiteType}`);
                }
                if (wizardData.timeline) {
                    const timelineLabels = {
                        aggressive: '1 month - Aggressive',
                        moderate: '3 months - Moderate',
                        gradual: '6 months - Gradual'
                    };
                    summaryItems.push(`<strong>Timeline:</strong> ${timelineLabels[wizardData.timeline]}`);
                }
                if (wizardData.contentCapacity) {
                    summaryItems.push(`<strong>Content Capacity:</strong> ${wizardData.contentCapacity}`);
                }
                if (wizardData.optimizationAreas && wizardData.optimizationAreas.length > 0) {
                    summaryItems.push(`<strong>Focus Areas:</strong> ${wizardData.optimizationAreas.join(', ')}`);
                }
                if (wizardData.moneyPages && wizardData.moneyPages.length > 0) {
                    const customMoneyCount = wizardData.customMoneyPages ? wizardData.customMoneyPages.length : 0;
                    const customSupportingCount = wizardData.customSupportingPages ? wizardData.customSupportingPages.length : 0;
                    const totalMoney = wizardData.moneyPages.length + customMoneyCount;
                    const totalSupporting = (wizardData.supportingPages?.length || 0) + customSupportingCount;
                    const customText = (customMoneyCount + customSupportingCount) > 0 ? ` (includes ${customMoneyCount + customSupportingCount} custom URLs)` : '';
                    summaryItems.push(`<strong>Priority Money Pages:</strong> ${totalMoney} selected${customText}`);
                    if (totalSupporting > 0) {
                        summaryItems.push(`<strong>Supporting Pages:</strong> ${totalSupporting} selected`);
                    }
                }
                if (wizardData.outputFormats && wizardData.outputFormats.length > 0) {
                    summaryItems.push(`<strong>Report Formats:</strong> ${wizardData.outputFormats.join(', ')}`);
                }
                
                $('#selectionsSummary').html(summaryItems.map(item => `<div>${item}</div>`).join(''));
            }

            function generateOptimizationReport() {
                // Show loading state
                $('#generateReport').html('Generating Report...').prop('disabled', true);
                
                console.log('Sending wizard data:', wizardData); // Debug log
                
                // Send data to backend for real report generation
                $.ajax({
                    url: 'process.php?action=generate_report',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(wizardData),
                    success: function(response) {
                        console.log('Report response:', response); // Debug log
                        if (response.success) {
                            displayReportResults(response);
                        } else {
                            console.error('Report error:', response);
                            alert('Error generating report: ' + (response.error || 'Unknown error'));
                        }
                        $('#generateReport').html('Generate Optimization Report').prop('disabled', false);
                    },
                    error: function(xhr, status, error) {
                        console.error('Report generation failed:', {
                            status: xhr.status,
                            statusText: xhr.statusText,
                            responseText: xhr.responseText,
                            error: error
                        });
                        alert(`Report generation failed (${xhr.status}): ${xhr.statusText}\n\nPlease check the console for details.`);
                        $('#generateReport').html('Generate Optimization Report').prop('disabled', false);
                    }
                });
            }


            function displayReportResults(response) {
                const analysis = response.analysis;
                const reports = response.reports;
                
                // Show the results section
                $('#reportResults').removeClass('hidden');
                
                // Display report summary
                const reportSummary = `
                    <div class="bg-white rounded-lg p-6 mb-4">
                        <div class="text-center mb-6">
                            <div class="inline-flex items-center justify-center w-24 h-24 rounded-full text-white font-bold text-2xl mb-4" 
                                 style="background-color: ${getScoreColor(analysis.overall.score)}">
                                ${analysis.overall.score}
                            </div>
                            <h3 class="text-2xl font-bold text-gray-800">Overall Score: ${analysis.overall.score}/100 (${analysis.overall.grade})</h3>
                            <p class="text-gray-600">Based on analysis of ${analysis.overall.totalPages} pages</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-blue-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${analysis.analytics.distribution.money}</div>
                                <div class="text-blue-800">Money Pages</div>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-green-600">${analysis.analytics.distribution.supporting}</div>
                                <div class="text-green-800">Supporting Pages</div>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-purple-600">${analysis.analytics.distribution.traffic}</div>
                                <div class="text-purple-800">Traffic Pages</div>
                            </div>
                        </div>
                    </div>
                `;
                
                $('#reportContent').html(reportSummary);
                
                // Display download links
                let downloadLinksHtml = '';
                
                if (reports.html) {
                    downloadLinksHtml += `
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">HTML Report</div>
                                <div class="text-sm text-gray-600">${(reports.html.size / 1024).toFixed(1)} KB</div>
                            </div>
                            <a href="${reports.html.path}" target="_blank" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                View Report
                            </a>
                        </div>
                    `;
                }
                
                if (reports.csv) {
                    downloadLinksHtml += `
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">CSV Data</div>
                                <div class="text-sm text-gray-600">${(reports.csv.size / 1024).toFixed(1)} KB</div>
                            </div>
                            <a href="${reports.csv.path}" download class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                                Download CSV
                            </a>
                        </div>
                    `;
                }
                
                $('#downloadLinks').html(downloadLinksHtml);
                
                // Scroll to results
                $('#reportResults')[0].scrollIntoView({ behavior: 'smooth' });
            }

            function getScoreColor(score) {
                if (score >= 80) return '#10b981';
                if (score >= 60) return '#f59e0b';
                return '#ef4444';
            }

            function loadAllPagesData() {
                console.log('Loading all pages data for local autocomplete...');
                
                // Load all pages for fast local search
                $.ajax({
                    url: 'process.php?action=search_pages',
                    method: 'GET',
                    data: { query: '', type: 'all' }, // Empty query to get all pages
                    success: function(response) {
                        if (response.suggestions) {
                            allPagesData = response.suggestions;
                            console.log('Loaded', allPagesData.length, 'pages for local search');
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('Failed to load pages data:', error);
                        // Fallback to AJAX search if loading fails
                    }
                });
            }

            function getSelectedOtherPages(type) {
                const containerId = type === 'money' ? '#selectedOtherMoneyPages' : '#selectedOtherSupportingPages';
                const pages = [];
                
                $(containerId + ' > div').each(function() {
                    const title = $(this).find('.font-medium').text();
                    const slug = $(this).data('slug') || ($(this).attr('id') || '').replace(new RegExp(`^selected-${type}-`), '');
                    const url = $(this).data('url') || '';
                    pages.push({ title, slug, url });
                });
                
                return pages;
            }
        });

        // Global functions for page selection
        function addSelectedPage(page, type) {
            const containerId = type === 'money' ? '#selectedOtherMoneyPages' : '#selectedOtherSupportingPages';
            const pageId = `selected-${type}-${page.slug}`;
            
            // Check if already selected
            if ($(`#${pageId}`).length > 0) {
                return;
            }
            
            const selectedPageHtml = `
                <div id="${pageId}" class="flex items-center justify-between bg-gray-100 p-3 rounded-lg" data-slug="${page.slug}" data-url="${page.url}">
                    <div>
                        <div class="font-medium text-gray-800">${page.title}</div>
                        <div class="text-sm text-gray-600">ILR: ${page.ilr}, Links: ${page.incomingLinks}</div>
                    </div>
                    <button type="button" class="text-red-600 hover:text-red-800 font-bold" onclick="removeSelectedPage('${pageId}')">√ó</button>
                </div>
            `;
            
            $(containerId).append(selectedPageHtml);
        }

        function removeSelectedPage(pageId) {
            $(`#${pageId}`).remove();
        }

        function removeCustomPage(pageId) {
            $(`#${pageId}`).remove();
        }

        // Handle suggestion selection
        $(document).on('click', '.suggestion-item', function() {
            const pageData = JSON.parse($(this).attr('data-page'));
            const type = $(this).attr('data-type');
            
            addSelectedPage(pageData, type);
            
            // Clear input and hide dropdown
            if (type === 'money') {
                $('#otherMoneyPages').val('');
                $('#moneyPagesDropdown').addClass('hidden');
            } else {
                $('#otherSupportingPages').val('');
                $('#supportingPagesDropdown').addClass('hidden');
            }
        });
    </script>
</body>
</html>
